:root {
    --bg-clear: linear-gradient(to bottom, #87CEEB, #5F9EA0);
    --bg-rain-soon: linear-gradient(to bottom, #B0C4DE, #778899);
    --bg-raining: linear-gradient(to bottom, #708090, #4682B4);
    --bg-loading: linear-gradient(to bottom, #f0f0f0, #dcdcdc);
    --card-bg: rgba(255, 255, 255, 0.88); /* Slightly more opaque */
    --text-color: #333;
    --text-color-light: #f8f8f8;
    --header-text-color: rgba(255, 255, 255, 0.95);
    --accent-color: #4682B4;
    --error-color: #DC143C;
    --shadow: 0 8px 20px rgba(0, 0, 0, 0.12); /* Slightly softer shadow */
    --text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    --border-radius: 12px; /* Slightly smaller radius */

    /* Define base vertical padding/margin using vh but clamp it */
    --base-vertical-space: clamp(10px, 2vh, 25px);
    --header-bottom-margin: clamp(10px, 2.5vh, 30px);
    --card-padding-vertical: clamp(15px, 2.5vh, 30px);
    --footer-padding-vertical: clamp(8px, 1.5vh, 20px);

     /* Define base font sizes using vw/vh but clamp them */
    --font-size-business: clamp(1.1em, 2.2vh, 1.6em);
    --font-size-appname: clamp(1.5em, 3vh, 2.2em);
    --font-size-purpose: clamp(0.8em, 1.8vh, 0.95em);
    --font-size-status: clamp(1.3em, 2.8vh, 1.8em);
    --font-size-location: clamp(0.9em, 1.9vh, 1.1em);
    --font-size-details: clamp(0.8em, 1.7vh, 0.95em);
    --font-size-current: clamp(0.75em, 1.6vh, 0.9em);
    --font-size-updated: clamp(0.7em, 1.4vh, 0.8em);
    --font-size-footer: clamp(0.7em, 1.4vh, 0.85em);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html, body {
    height: 100%; /* Ensure html and body take full height */
    overflow: hidden; /* Prevent scrollbars at the highest level */
}

body {
    font-family: 'Poppins', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    /* min-height: 100vh; height: 100% is preferred with overflow:hidden */
    background: var(--bg-loading);
    color: var(--text-color);
    transition: background 0.8s ease-in-out;
    padding: 0 5px; /* Small horizontal padding */
}

/* Header Section Styling */
.app-header {
    text-align: center;
    width: 95%;
    max-width: 700px;
    margin-top: var(--base-vertical-space);
    margin-bottom: var(--header-bottom-margin);
    color: var(--header-text-color);
    flex-shrink: 0; /* Prevent header from shrinking */
}

.business-name {
    font-size: var(--font-size-business);
    font-weight: 700;
    text-shadow: var(--text-shadow);
    letter-spacing: 0.5px;
    margin-bottom: clamp(2px, 0.5vh, 5px); /* Very small space */
    opacity: 0.9;
}

.app-name {
    font-size: var(--font-size-appname);
    font-weight: 600;
    text-shadow: var(--text-shadow);
    margin-bottom: clamp(5px, 1.5vh, 15px);
    color: white;
}

.app-purpose {
    font-size: var(--font-size-purpose);
    font-weight: 300;
    line-height: 1.5; /* Adjusted line height */
    opacity: 0.9;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.25);
    max-width: 550px;
    margin-left: auto;
    margin-right: auto;
}

/* Container to center the card */
.container {
    display: flex;
    justify-content: center;
    align-items: center; /* Center card vertically */
    width: 100%;
    flex-grow: 1; /* Allow container to take up remaining space */
    overflow: hidden; /* Hide overflow within the container */
    min-height: 0; /* Important for flex-grow in some browsers */
    padding: 5px 0; /* Small vertical padding */
}

.weather-card {
    background: var(--card-bg);
    padding: var(--card-padding-vertical) clamp(15px, 5vw, 40px); /* Vertical padding uses clamped var */
    border-radius: var(--border-radius);
    box-shadow: var(--shadow);
    text-align: center;
    min-width: 280px; /* Reduce min-width */
    max-width: 480px; /* Reduce max-width */
    width: 90%;
    backdrop-filter: blur(4px); /* Slightly less blur */
    transition: background 0.5s ease;
    overflow: hidden; /* Prevent internal overflow */
    /* Removed margin-top, container alignment handles it */
    max-height: 95%; /* Limit card height relative to container */
    display: flex; /* Use flex to manage internal content */
    flex-direction: column;
    justify-content: center; /* Center content vertically in card */
}

/* --- Loading/Content/Error Switching --- */
/* Make sure only one state is visible */
#loading, #content, #error { display: none; } /* Hide all by default */
#weather-card > div { /* Style direct children */
     flex-grow: 1; /* Allow the visible div to grow */
     display: flex; /* Use flex inside each state view */
     flex-direction: column;
     justify-content: center;
     align-items: center;
     width: 100%;
}
/* JS will set the correct one to display: flex */


/* --- Loading State --- */
.loading {
    gap: clamp(8px, 2vh, 15px);
    font-size: var(--font-size-details);
    color: #555;
}
.loading i {
    font-size: clamp(1.8em, 4vh, 2.5em);
    color: var(--accent-color);
}

/* --- Content Styling --- */
.content {
    gap: clamp(5px, 1.5vh, 15px); /* Reduced gap */
}

.location {
    font-size: var(--font-size-location);
    font-weight: 300;
    color: #555;
}
.location i { margin-right: 5px; color: var(--accent-color); }

.status h2 {
    font-size: var(--font-size-status);
    font-weight: 600;
    margin-bottom: 0; /* Removed margin */
    color: var(--accent-color);
    transition: color 0.5s ease;
    line-height: 1.2; /* Tighter line height */
}
.status i { margin-right: 5px; }

.details p, .forecast p, .current-weather p {
    font-size: var(--font-size-details);
    line-height: 1.4; /* Tighter */
    color: #444;
    margin-bottom: clamp(2px, 0.5vh, 5px); /* Small gap */
}

.forecast, .current-weather {
    margin-top: clamp(5px, 1vh, 10px); /* Reduced margin */
    padding-top: clamp(5px, 1vh, 10px); /* Reduced padding */
    border-top: 1px solid rgba(0, 0, 0, 0.08); /* Lighter border */
    width: 90%; /* Limit width slightly */
}
.current-weather { font-size: var(--font-size-current); color: #666; }
.current-weather i { margin-right: 4px; color: var(--accent-color); }
.current-weather img { vertical-align: middle; height: 18px; width: 18px; margin-left: 3px; }

.last-updated {
    margin-top: clamp(5px, 1vh, 10px); /* Reduced margin */
    font-size: var(--font-size-updated);
    color: #888;
    font-style: italic;
}

/* --- Dynamic Styling based on Weather State --- */
body.state-clear { background: var(--bg-clear); }
body.state-rain-soon { background: var(--bg-rain-soon); }
body.state-raining { background: var(--bg-raining); }

.weather-card.state-clear .status h2 { color: #2E8B57; }
.weather-card.state-rain-soon .status h2 { color: #DAA520; }
.weather-card.state-raining .status h2 { color: #4169E1; }

/* --- Error State --- */
.error {
    gap: clamp(5px, 1.5vh, 10px);
    color: var(--error-color);
    padding: 10px;
}
.error i { font-size: clamp(1.8em, 4vh, 2.5em); }
.error p { font-weight: 600; font-size: var(--font-size-details); }
.error span { font-size: var(--font-size-updated); color: #555; }

/* Footer Styling */
.app-footer {
    text-align: center;
    margin-top: auto; /* Keep footer pushed down */
    padding: var(--footer-padding-vertical) 10px; /* Use clamped var */
    font-size: var(--font-size-footer);
    color: rgba(255, 255, 255, 0.75);
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    width: 100%;
    flex-shrink: 0; /* Prevent footer from shrinking */
}
.app-footer p { margin: 0; }

/* --- Transitions --- */
#content, #loading, #error { transition: opacity 0.4s ease-in-out; } /* Faster transition */

/* --- Height-Based Adjustments --- */
/* Example: Very short screens */
@media (max-height: 550px) {
    :root {
        /* Override clamped variables for very short screens */
        --base-vertical-space: 8px;
        --header-bottom-margin: 8px;
        --card-padding-vertical: 10px;
        --footer-padding-vertical: 5px;

        --font-size-business: 1em;
        --font-size-appname: 1.3em;
        --font-size-purpose: 0.7em;
        --font-size-status: 1.1em;
        --font-size-location: 0.8em;
        --font-size-details: 0.75em;
        --font-size-current: 0.7em;
        --font-size-updated: 0.65em;
        --font-size-footer: 0.65em;
    }
    .app-purpose { line-height: 1.4; } /* Tighten further */
    .forecast, .current-weather { padding-top: 5px; margin-top: 5px; }
    .last-updated { margin-top: 5px; }
    .current-weather img { height: 16px; width: 16px; }
    .loading i, .error i { font-size: 1.6em; }
}

/* Optional: Hide purpose paragraph on extremely short screens */
@media (max-height: 450px) {
    .app-purpose {
       display: none; /* Hide purpose if space is extremely limited */
    }
     :root { /* Further reduction */
        --font-size-business: 0.9em;
        --font-size-appname: 1.1em;
        --font-size-status: 1em;
        --font-size-location: 0.75em;
     }
}

/* Standard Width-Based Responsive (Keep these too) */
@media (max-width: 480px) {
    .weather-card {
        min-width: unset; /* Allow it to be smaller */
    }
}
